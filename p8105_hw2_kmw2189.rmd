---
title: "Homework 2"
author: "Kylie Wheelock Riley"
date: "9/25/2019"
output: github_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

# Problem 1

## Importing and tidying Mr. Trash Wheel Data
```{r trash wheel import, message = FALSE}
library(readxl)
trash_wheel = read_excel(path = "./data/mr_trash_wheel_data_aug19.xlsx", 1) %>%
  janitor::clean_names() %>% 
  rename(vol_y3 = volume_cubic_yards, cigs = cigarette_butts) %>% 
  select(-x15) %>% 
  drop_na(dumpster:date) %>%
  mutate(sports_balls = round(sports_balls, 0)) %>% 
  mutate(sports_balls = as.integer(sports_balls))
```

## Importing and tidying 2017 precipitation data
```{r cleaning 2017 precipitation}
precip_2017 = read_excel(path = "./data/mr_trash_wheel_data_aug19.xlsx", 6, skip = 1) %>% 
  janitor::clean_names() %>% 
  rename(total_in = total) %>% 
    mutate(
    total_in = na_if(total_in, 0),
    year = "2017") %>% 
  drop_na(total_in, month) %>% 
  select(year, month, total_in)
```

## Importing and tidying 2018 precipitation data
```{r cleaning 2018 precipitation}
precip_2018 = read_excel(path = "./data/mr_trash_wheel_data_aug19.xlsx", 5, skip = 1) %>% 
  janitor::clean_names() %>% 
  rename(total_in = total) %>% 
  mutate(
    total_in = na_if(total_in, 0),
    year = "2018") %>% 
   drop_na(total_in, month) %>% 
  select(year, month, total_in)
```

## Joining 2017 and 2018 precipitation data
```{r binding 2017 & 2018 precip data}
precip_bind = bind_rows(precip_2017, precip_2018) %>% 
  mutate(month = month.name[month])
    
```

```{r data summary work, include = FALSE}
mean_trash_wheel = mean(pull(trash_wheel, weight_tons))
mean_cubic_yars = mean(pull(trash_wheel, vol_y3))
total_precip_17 = sum(pull(precip_2017, total_in))
total_precip_18 = sum(pull(precip_2018, total_in))
median_balls_17 = median(pull(trash_wheel, sports_balls), year = 2017)
median_balls_18 = median(pull(trash_wheel, sports_balls), year = 2018)
avg_balls_total = mean(pull(trash_wheel, sports_balls))
```

Mr. Trash Wheel is a trash interceptor that removes trash as it enters Baltimore's Inner Harbor. Between May 2014 and August 2019 Mr.Trash Wheel brought in a  total of `r nrow(trash_wheel)` dumpsters full of trash. The average dumpster weighed  `r round(mean_trash_wheel, digits = 2)` tons with a volume of `r round(mean_cubic_yars, digits = 2)` cubic yards. Trash collected in the dumpsters included cigarette butts, plastic bottles, sports balls, and grocery bags, among others. Mr. Trash Wheel is most active just after a precipitation event.  Between 2017 and 2018 there was a total of `r nrow(precip_bind)` months with precipitation. 2017 had lower total precipitation with  `r round(total_precip_17, digits = 2)` inches compared to a total of `r round(total_precip_18, digits = 2)` inches in 2018. The median number of sports balls collected per dumpster in 2017 was `r median_balls_17` and the 2018 median was also `r median_balls_18`.


# Problem 2

## Importing and tidying the monthly poll data
```{r importing and tidying pols_month data}
## Importing dataset
pols_month = read_csv(file = "./data/pols_month.csv") %>% 
  ## separating month from 1 column into 3
  separate(mon, into = c("year", "month", "day"), sep = "-") %>% 
   mutate(
    ## mutate month into numeric in order to use the month.name var
    month = as.numeric(month),
    month = month.name[month],
    ## converting year to integer to keep consistent in merge
    year = as.integer(year),
    president = ifelse(prez_gop > 0, "gop", "dem")
    ) %>%
  select(-prez_dem, -prez_gop, -day) %>% 
  arrange(year, month, desc(year))

```

## Importing and tidying the S&P data
```{r importing and tidying snp data}
snp_data = read_csv(file = "./data/snp.csv") %>% 
  mutate( 
    date = lubridate::mdy(date)
    ) %>% 
  separate(date, into = c("year", "month", "day"), sep = "-") %>% 
  mutate(
    month = as.numeric(month),
    month = month.name[month], 
    year = as.integer(year),
  ) %>% 
  select(-day) %>% 
  arrange(year, month, desc(year))
  
```

## Importing and tidying unemployment dataset
```{r importing and tidying unelmployment data}
unemploy_data = read_csv(file = "./data/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    jan:dec,
    names_to = "month", 
    values_to = "unemploy_pct"
    ) %>%
  mutate(
    year = as.integer(year),
    month = recode(month, "jan" = "January", "feb" = "February", "mar" = "March", "apr" = "April", "may" = "May", "jun" = "June", "jul" = "July", "aug" = "August", "sep" = "September", "oct" = "October", "nov" = "November", "dec" = "December")
  ) %>% 
  arrange(year, month, desc(year))

```


## Merging 
```{r merging pols snp and unemploy data}
## snp_data into pols_month data 
pols_month_snp_data = 
  left_join(pols_month, snp_data, by = c("year", "month"))

## unemploy_data into pols_month and snp combined
pols_snp_unemploy_data =
  left_join(pols_month_snp_data, unemploy_data, by = c("year", "month"))
```

Write a short paragraph about these datasets. Explain briefly what each dataset contained, and describe the resulting dataset (e.g. give the dimension, range of years, and names of key variables).

The data contained in Problem 2 summarizes the politicial parties in the house, senate, and president monthly starting in ##r min(pull, `.

# Problem 3

## Importing and tidying baby names data
```{r, importing and tidying baby_names data}
baby_names = read_csv(file = "./data/popular_baby_names.csv") %>% 
  janitor::clean_names() %>%
  rename(year = year_of_birth , name = childs_first_name) %>% 
  mutate(
    year = as.factor(year),
    rank = as.numeric(rank),
    ethnicity = recode(ethnicity,"ASIAN AND PACI" = "ASIAN AND PACIFIC ISLANDER", "BLACK NON HISP" = "BLACK NON HISPANIC", "WHITE NON HISP" = "WHITE NON HISPANIC"),
    name = as.factor(toupper(name))
    ) %>% 
  distinct() %>% 
  select(year, name, rank, gender, ethnicity, count)
  

```


## Rank of Olivia as a baby name in NYC by ethnicity
```{r olivia table}
baby_names %>% 
  filter(name == "OLIVIA") %>%
  pivot_wider(
  names_from = "year", 
  values_from = "rank"
  ) %>% 
  knitr::kable()

```

 
## Rank of popular boy names in NYC
```{r}
baby_names %>% 
  filter(rank == 1, gender == "MALE") %>%
  pivot_wider(
  names_from = "year", 
  values_from = "name"
  ) %>% 
  knitr::kable()
```


## Scatterplot of count and rank of popular baby names for Non Hispanic While Males born in 2016 in NYC
```{r scatterplot}
baby_names %>% 
  filter(gender == "MALE", ethnicity == "WHITE NON HISPANIC", year == 2016) %>% 
  ggplot(aes(x = rank, y = count)) + geom_point()

```

